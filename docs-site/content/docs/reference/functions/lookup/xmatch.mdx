---
title: "XMATCH"
description: "Returns the 1-based position of a value in a one-dimensional lookup array."
---

## Summary

`XMATCH` extends `MATCH` with explicit search direction and wildcard mode.

## Remarks
 - Defaults: `match_mode=0` (exact), `search_mode=1` (first-to-last).
 - `match_mode`: `0` exact, `-1` exact-or-next-smaller, `1` exact-or-next-larger, `2` wildcard.
 - `search_mode`: `1` forward, `-1` reverse, `2` ascending binary intent, `-2` descending binary intent.
 - `lookup_array` must be a single row or single column, otherwise returns `#VALUE!`.
 - Not found returns `#N/A`.

## Examples

<Tabs items={["Exact match position", "Reverse search finds last duplicate"]}>
<Tab value="Exact match position">
<FunctionSandbox
  title="Exact match position"
  formula={`=XMATCH("beta",A1:A3)`}
  grid={{"A1":"alpha","A2":"beta","A3":"gamma"}}
  expected={"2"}
/>
</Tab>

<Tab value="Reverse search finds last duplicate">
<FunctionSandbox
  title="Reverse search finds last duplicate"
  formula={`=XMATCH(7,A1:A3,0,-1)`}
  grid={{"A1":"7","A2":"9","A3":"7"}}
  expected={"3"}
/>
</Tab>

</Tabs>

## Runtime metadata

{/* [formualizer-docgen:function-meta:start] */}
<FunctionMeta id="lookup/xmatch" />
{/* [formualizer-docgen:function-meta:end] */}
