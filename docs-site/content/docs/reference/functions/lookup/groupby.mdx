---
title: "GROUPBY"
description: "GROUPBY: Groups rows by key fields and returns aggregated values as a spilled table."
---

<FunctionPageSchema id="lookup/groupby" />

## Summary

`GROUPBY` summarizes one or more value columns using a selected aggregation function.

## Remarks
 - `row_fields` and `values` must have the same row count.
 - Aggregation can be supplied as text (for example `"SUM"`) or numeric code.
 - Optional controls: `field_headers`, `total_depth`, `sort_order`.
 - Invalid aggregation names/codes return `#VALUE!`.
 - Output is dynamic-array shaped and may include generated headers or totals.

## Examples

<Tabs items={["Sum sales by region", "Average with grand total"]}>
<Tab value="Sum sales by region">
<FunctionSandbox
  title="Sum sales by region"
  formula={`=GROUPBY(A1:A4,B1:B4,"SUM",3,0,1)`}
  grid={{"A1":"Region","A2":"East","A3":"West","A4":"East","B1":"Sales","B2":"100","B3":"80","B4":"50"}}
  expected={"[[\"Region\",\"Sales\"],[\"East\",150],[\"West\",80]]"}
/>
</Tab>

<Tab value="Average with grand total">
<FunctionSandbox
  title="Average with grand total"
  formula={`=GROUPBY(A1:A4,B1:B4,"AVERAGE",3,1,1)`}
  grid={{"A1":"Team","A2":"A","A3":"A","A4":"B","B1":"Score","B2":"90","B3":"70","B4":"80"}}
  expected={"Grouped table with team averages plus grand total row"}
/>
</Tab>

</Tabs>

## Related functions

- [PIVOTBY](/docs/reference/functions/lookup/pivotby)
- [SORTBY](/docs/reference/functions/lookup/sortby)
- [UNIQUE](/docs/reference/functions/lookup/unique)
- [XLOOKUP](/docs/reference/functions/lookup/xlookup)
- [CHOOSECOLS](/docs/reference/functions/lookup/choosecols)
- [CHOOSEROWS](/docs/reference/functions/lookup/chooserows)

## FAQ

### What shape constraints does GROUPBY enforce?
row_fields and values must have the same number of rows; mismatched heights return #VALUE!.

### Can the aggregation function be numeric instead of text?
Yes. GROUPBY accepts either function names (like "SUM") or numeric function codes, and invalid entries return #VALUE!.

## Runtime metadata

{/* [formualizer-docgen:function-meta:start] */}
<FunctionMeta id="lookup/groupby" />
{/* [formualizer-docgen:function-meta:end] */}
